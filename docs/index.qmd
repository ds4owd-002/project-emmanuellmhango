---
title: "My Project"
format: html
editor: visual
---

## Uganda Waterpoints

This dataset provides comprehensive information on **water points across Uganda**. This dataset is a free dataset shared through [The Humanitatian Data Exchange](https://data.humdata.org/dataset/wpdx_uga "Uganda Water points Data"). Each entry represents an individual water source, such as a well or a rainwater harvesting system, with associated details covering location, type, functionality, management, and usage.

Key attributes include:

-   **Geographical information:** Latitude, longitude, and administrative divisions (region, district, sub-county).

-   **Water source and technology:** The type of water source (e.g., protected well, rainwater harvesting) and the technology used.

-   **Operational status:** Whether the water point is functional or non-functional.

-   **Management and governance:** How the water point is managed (community-managed, fee-based, etc.) and the organization responsible.

-   **Installation and maintenance history:** Year of installation, rehabilitation records, and organizations involved.

-   **Population served:** The number of people served within the vicinity of the water point.

-   **Water quality indicators:** Includes parameters such as fecal contamination presence and subjective quality assessments.

-   **Proximity metrics:** Distances to urban centers, primary, secondary, and tertiary water sources.

**Analysis Goals:**\
The primary goals of analyzing this dataset are:

1.  **Monitoring and Evaluation (M&E):** Assess the operational status and functionality of water points across different regions to track performance, identify trends, and support evidence-based decision-making.

2.  **Risk Assessment:** Identify areas at higher risk of water point failure, contamination, or insufficient coverage to prioritize interventions, rehabilitation, and resource allocation.

This dataset serves as a detailed resource for monitoring water access and quality in Uganda, supporting strategic planning, management effectiveness assessment, and risk-informed decision-making for water infrastructure.

## Import

To load the data, you should first load the required libraries to use:

```{r}
library(tidyverse)
library(here)
library(lubridate)
```

Now, load your dataset like this

```{r}
#| echo: false
data <- read_csv(here::here("data/raw/wpdx_enhanced.csv"))
```

Now, we will write code to bring your data into a state where itâ€™s ready for analysis.

-   Rename columns with `rename()`

-   Select columns that are relevant with `select()`

-   Remove missing values with `filter()` or `drop_na()`

-   Join several dataframes with `left_join()`, `right_join()`, etc.

-   Create new variables with `mutate()`

```{r}
#| echo: false 
data <- data |>
   select(
    -c(
      prediction_yes_0y,
      prediction_yes_2y,
      prediction_no_0y,
      prediction_no_2y,
      clean_adm1,
      clean_adm2,
      clean_adm3,
      clean_adm4,
      activity_id,
      scheme_id,
      notes,
      wpdx_id,
      predicted_status_0y,
      predicted_status_2y,
      predicted_category
    )
  ) |>
  rename(water_source_type = water_source_clean) |>
  mutate(report_date = mdy(report_date)) |>
  mutate(report_date = format(report_date, "%d/%m/%Y"))
 
  colnames(data)
```

Save the processed data into a CSV file

```{r}
write_csv(data,
          here::here("data/processed/my-processed-data.csv"))
```

## Visualization

Visualization is important because it visually represents the data. The dataset used, we will visualize 2 graphs:

### 1. Bar graph of impacted people by the resource type

```{r}
# Summarize population affected by water point status
population_status <- data %>%
  group_by(status_clean) %>%
  summarize(total_population = sum(assigned_population, na.rm = TRUE))

# Plot
ggplot(population_status, aes(x = status_clean, y = total_population, fill = status_clean)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(
    title = "Population Affected by Water Point Functionality",
    x = "Water Point Status",
    y = "Total Population Affected"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::label_number(big.mark = ",")) +
  scale_fill_brewer(palette = "Set2") +
  geom_text(aes(label = scales::label_number(big.mark = ",")(total_population)), hjust = -0.1) +
   theme(legend.position = "none")

```

### 2. Scatter Plot (Criticality vs Pressure)

This scatter plot shows the relationship between **pressure** (how heavily a water point is used) and **criticality** (how essential or high-risk the water point is).

```{r}
data |> 
  drop_na(pressure, criticality) |>
  ggplot(aes(x = pressure, y = criticality)) +
  geom_point(alpha = 0.4, size = 2, color = "steelblue") +
  geom_smooth(method = "loess", se = FALSE, color = "red") +
  labs(
    title = "Criticality vs Pressure",
    x = "Pressure (Usage Pressure)",
    y = "Criticality Score"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```
